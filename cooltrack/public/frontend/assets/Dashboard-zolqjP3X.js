import{f as H,e as g,g as L,j as e,p as i,s as _,b as C,a,c as r,m as c,h as S,i as D,d as Y,o as d,L as o,k as m,q as u,t as F,v as R}from"./index-BVgz5S1Z.js";import{d as f}from"./dayjs.min-DpI5YeyT.js";import{o as y}from"./grid-BDn360O0.js";import{o as n}from"./card-M61IZ-ns.js";const V=()=>{const{currentUser:x}=H(),{data:l,isLoading:p}=g("Sensor",{fields:["name","sensor_id","status","gateway_id"],limit:5,orderBy:{field:"modified",order:"desc"}}),{data:t,isLoading:b}=g("Sensor Gateway",{fields:["name","gateway_type","status","last_heartbeat"],limit:5,orderBy:{field:"modified",order:"desc"}}),{data:h,isLoading:v}=g("Notification Log",{fields:["name","subject","creation","read"],filters:[["for_user","=",x],["type","=","Alert"]],limit:5,orderBy:{field:"creation",order:"desc"}}),{data:j,mutate:w}=L("frappe.client.get_count",{doctype:"Notification Log",filters:JSON.stringify({for_user:x,read:0,type:"Alert"})},void 0,{revalidateOnFocus:!0}),N=(l==null?void 0:l.filter(s=>s.status==="Active").length)||0,z=(t==null?void 0:t.filter(s=>s.status==="Online").length)||0,A=(j==null?void 0:j.message)||0;return p||b||v?e.jsx(i,{justify:"center",align:"center",className:"h-[80vh]",children:e.jsx(_,{size:"3"})}):e.jsxs(C,{className:"min-h-screen bg-gray-50 p-4 md:p-6",children:[e.jsxs(i,{justify:"between",align:"center",mb:"6",children:[e.jsx(a,{size:"7",weight:"bold",children:"Dashboard"}),e.jsxs(r,{color:"gray",children:["Welcome back, ",x]})]}),e.jsxs(y,{columns:{initial:"1",sm:"3"},gap:"4",mb:"6",children:[e.jsx(c.div,{whileHover:{y:-2},children:e.jsx(n,{size:"3",children:e.jsxs(i,{gap:"4",align:"center",children:[e.jsx("div",{className:"p-3 rounded-full bg-green-100",children:e.jsx(S,{className:"text-green-600 text-xl"})}),e.jsxs(i,{direction:"column",children:[e.jsx(r,{size:"2",color:"gray",children:"Active Sensors"}),e.jsxs(a,{size:"6",children:[N,"/",(l==null?void 0:l.length)||0]})]})]})})}),e.jsx(c.div,{whileHover:{y:-2},children:e.jsx(n,{size:"3",children:e.jsxs(i,{gap:"4",align:"center",children:[e.jsx("div",{className:"p-3 rounded-full bg-blue-100",children:e.jsx(D,{className:"text-blue-600 text-xl"})}),e.jsxs(i,{direction:"column",children:[e.jsx(r,{size:"2",color:"gray",children:"Online Gateways"}),e.jsxs(a,{size:"6",children:[z,"/",(t==null?void 0:t.length)||0]})]})]})})}),e.jsx(c.div,{whileHover:{y:-2},children:e.jsx(n,{size:"3",children:e.jsxs(i,{gap:"4",align:"center",children:[e.jsx("div",{className:"p-3 rounded-full bg-red-100",children:e.jsx(Y,{className:"text-red-600 text-xl"})}),e.jsxs(i,{direction:"column",children:[e.jsx(r,{size:"2",color:"gray",children:"Unread Alerts"}),e.jsx(a,{size:"6",children:A})]})]})})})]}),e.jsxs(y,{columns:{initial:"1",lg:"2"},gap:"6",children:[e.jsxs(n,{children:[e.jsxs(i,{justify:"between",align:"center",mb:"4",children:[e.jsx(a,{size:"5",children:"Recent Sensors"}),e.jsx(d,{variant:"ghost",asChild:!0,children:e.jsxs(o,{to:"/sensors",children:["View All ",e.jsx(m,{className:"ml-2"})]})})]}),e.jsx(i,{direction:"column",gap:"3",children:l!=null&&l.length?l.map(s=>e.jsx(c.div,{whileHover:{x:2},children:e.jsx(n,{variant:"classic",children:e.jsxs(i,{justify:"between",align:"center",children:[e.jsxs(i,{direction:"column",children:[e.jsxs(r,{weight:"bold",children:["ID: ",s.sensor_id]}),e.jsxs(r,{size:"2",color:"gray",children:["Gateway: ",s.gateway_id]})]}),e.jsx(u,{color:s.status==="Active"?"green":s.status==="Maintenance"?"orange":"gray",children:s.status})]})})},s.name)):e.jsx(n,{children:e.jsx(i,{justify:"center",align:"center",py:"4",children:e.jsx(r,{color:"gray",children:"No sensors found"})})})})]}),e.jsxs(n,{children:[e.jsxs(i,{justify:"between",align:"center",mb:"4",children:[e.jsx(a,{size:"5",children:"Recent Alerts"}),e.jsx(d,{variant:"ghost",asChild:!0,onClick:()=>w(),children:e.jsxs(o,{to:"/alerts",children:["View All ",e.jsx(m,{className:"ml-2"})]})})]}),e.jsx(i,{direction:"column",gap:"3",children:h!=null&&h.length?h.map(s=>e.jsx(c.div,{whileHover:{x:2},children:e.jsx(n,{className:`${s.read?"":"border-l-4 border-red-500"}`,children:e.jsxs(i,{direction:"column",gap:"1",children:[e.jsx(r,{weight:"bold",children:s.subject}),e.jsxs(i,{justify:"between",children:[e.jsx(r,{size:"2",color:"gray",children:f(s.creation).format("YYYY-MM-DD HH:mm")}),!s.read&&e.jsx(u,{color:"red",children:"New"})]})]})})},s.name)):e.jsx(n,{children:e.jsx(i,{justify:"center",align:"center",py:"4",children:e.jsx(r,{color:"gray",children:"No recent alerts"})})})})]}),e.jsxs(n,{children:[e.jsxs(i,{justify:"between",align:"center",mb:"4",children:[e.jsx(a,{size:"5",children:"Gateway Status"}),e.jsx(d,{variant:"ghost",asChild:!0,children:e.jsxs(o,{to:"/gateways",children:["View All ",e.jsx(m,{className:"ml-2"})]})})]}),e.jsx(i,{direction:"column",gap:"3",children:t!=null&&t.length?t.map(s=>e.jsx(c.div,{whileHover:{x:2},children:e.jsx(n,{children:e.jsxs(i,{justify:"between",align:"center",children:[e.jsxs(i,{direction:"column",children:[e.jsx(r,{weight:"bold",children:s.gateway_type}),e.jsxs(r,{size:"2",color:"gray",children:["Last seen: ",s.last_heartbeat?f(s.last_heartbeat).format("YYYY-MM-DD HH:mm"):"Never"]})]}),e.jsx(u,{color:s.status==="Online"?"green":s.status==="Maintenance"?"orange":"gray",children:s.status})]})})},s.name)):e.jsx(n,{children:e.jsx(i,{justify:"center",align:"center",py:"4",children:e.jsx(r,{color:"gray",children:"No gateways found"})})})})]}),e.jsxs(n,{children:[e.jsx(a,{size:"5",mb:"4",children:"Quick Actions"}),e.jsxs(y,{columns:"2",gap:"3",style:{height:"100%"},children:[e.jsx(c.div,{whileHover:{scale:1.05},children:e.jsx(d,{variant:"soft",asChild:!0,style:{height:"100px",display:"flex",justifyContent:"center",alignItems:"center",padding:"16px",borderRadius:"8px"},children:e.jsxs(o,{to:"/alerts",style:{display:"flex",alignItems:"center"},children:[e.jsx(F,{className:"mr-2"})," View Alerts"]})})}),e.jsx(c.div,{whileHover:{scale:1.05},children:e.jsx(d,{variant:"soft",asChild:!0,style:{height:"100px",display:"flex",justifyContent:"center",alignItems:"center",padding:"16px",borderRadius:"8px"},children:e.jsxs(o,{to:"/history",style:{display:"flex",alignItems:"center"},children:[e.jsx(R,{className:"mr-2"})," View History"]})})})]})]})]})]})};export{V as default};
