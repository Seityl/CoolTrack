var ne=Object.defineProperty,oe=Object.defineProperties;var le=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var B=(r,a,s)=>a in r?ne(r,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[a]=s,b=(r,a)=>{for(var s in a||(a={}))G.call(a,s)&&B(r,s,a[s]);if(E)for(var s of E(a))H.call(a,s)&&B(r,s,a[s]);return r},S=(r,a)=>oe(r,le(a));var k=(r,a)=>{var s={};for(var t in r)G.call(r,t)&&a.indexOf(t)<0&&(s[t]=r[t]);if(r!=null&&E)for(var t of E(r))a.indexOf(t)<0&&H.call(r,t)&&(s[t]=r[t]);return s};var I=(r,a,s)=>new Promise((t,c)=>{var n=d=>{try{y(s.next(d))}catch(p){c(p)}},m=d=>{try{y(s.throw(d))}catch(p){c(p)}},y=d=>d.done?t(d.value):Promise.resolve(d.value).then(n,m);y((s=s.apply(r,a)).next())});import{r as g,u as ce,a as de,j as e,c as pe,P as J,b as xe,e as he,Y as ue,o as ge,f as me,v as ye,y as O,g as je,i as fe,G as be,n as u,p as i,av as P,k as F,J as $,w as A,aw as N,ax as ve,m as h,a8 as D,z as Q,A as W,al as we,a9 as ze,$ as Se,ay as ke,x as Ce,az as U,ad as _e,K as Re,aA as Te,B as Ee}from"./index-BsqRx7K0.js";import{o as z}from"./card-Cl9jFH-U.js";import{o as Z}from"./grid-C-tyneNj.js";import{u as Fe}from"./index-BiKMrQoy.js";import{o as X}from"./separator-BoVDTRez.js";import{m as Ie,b as Pe,P as K,f as V}from"./tabs-CqwaVAKS.js";import{u as Ae}from"./text-field-DqTx62B3.js";import"./index-UYpWDUL8.js";var M="Switch",[Ne,ts]=pe(M),[Le,$e]=Ne(M),ee=g.forwardRef((r,a)=>{const q=r,{__scopeSwitch:s,name:t,checked:c,defaultChecked:n,required:m,disabled:y,value:d="on",onCheckedChange:p,form:v}=q,w=k(q,["__scopeSwitch","name","checked","defaultChecked","required","disabled","value","onCheckedChange","form"]),[f,o]=g.useState(null),l=ce(a,T=>o(T)),x=g.useRef(!1),j=f?v||!!f.closest("form"):!0,[R=!1,te]=de({prop:c,defaultProp:n,onChange:p});return e.jsxs(Le,{scope:s,checked:R,disabled:y,children:[e.jsx(J.button,S(b({type:"button",role:"switch","aria-checked":R,"aria-required":m,"data-state":ae(R),"data-disabled":y?"":void 0,disabled:y,value:d},w),{ref:l,onClick:xe(r.onClick,T=>{te(ie=>!ie),j&&(x.current=T.isPropagationStopped(),x.current||T.stopPropagation())})})),j&&e.jsx(De,{control:f,bubbles:!x.current,name:t,value:d,checked:R,required:m,disabled:y,form:v,style:{transform:"translateX(-100%)"}})]})});ee.displayName=M;var se="SwitchThumb",re=g.forwardRef((r,a)=>{const n=r,{__scopeSwitch:s}=n,t=k(n,["__scopeSwitch"]),c=$e(se,s);return e.jsx(J.span,S(b({"data-state":ae(c.checked),"data-disabled":c.disabled?"":void 0},t),{ref:a}))});re.displayName=se;var De=r=>{const d=r,{control:a,checked:s,bubbles:t=!0}=d,c=k(d,["control","checked","bubbles"]),n=g.useRef(null),m=Fe(s),y=he(a);return g.useEffect(()=>{const p=n.current,v=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(v,"checked").set;if(m!==s&&f){const o=new Event("click",{bubbles:t});f.call(p,s),p.dispatchEvent(o)}},[m,s,t]),e.jsx("input",S(b({type:"checkbox","aria-hidden":!0,defaultChecked:s},c),{tabIndex:-1,ref:n,style:S(b(b({},r.style),y),{position:"absolute",pointerEvents:"none",opacity:0,margin:0})}))};function ae(r){return r?"checked":"unchecked"}var We=ee,Me=re;const qe=["1","2","3"],Be=["classic","surface","soft"],Ge=b(b(b({size:{type:"enum",className:"rt-r-size",values:qe,default:"2",responsive:!0},variant:{type:"enum",className:"rt-variant",values:Be,default:"surface"}},me),ge),ue),_=g.forwardRef((r,a)=>{const m=ye(r,Ge,je),{className:s,color:t,radius:c}=m,n=k(m,["className","color","radius"]);return g.createElement(We,S(b({"data-accent-color":t,"data-radius":c},n),{asChild:!1,ref:a,className:O("rt-reset","rt-SwitchRoot",s)}),g.createElement(Me,{className:O("rt-SwitchThumb",{"rt-high-contrast":r.highContrast})}))});_.displayName="Switch";const He=({message:r,type:a,onClose:s})=>(g.useEffect(()=>{const t=setTimeout(()=>{s()},5e3);return()=>clearTimeout(t)},[s]),e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
          @keyframes slideIn {
            from {
              transform: translateX(100%);
              opacity: 0;
            }
            to {
              transform: translateX(0);
              opacity: 1;
            }
          }
        `}),e.jsxs("div",{style:{position:"fixed",bottom:"20px",right:"20px",zIndex:1e3,backgroundColor:a==="success"?"var(--green-9)":"var(--red-9)",color:"white",padding:"12px 16px",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)",display:"flex",alignItems:"center",gap:"8px",maxWidth:"300px",animation:"slideIn 0.3s ease-out"},children:[a==="success"?e.jsx(Q,{size:16}):e.jsx(W,{size:16}),e.jsx(h,{size:"2",children:r})]})]})),Oe={Active:e.jsx(ze,{size:16,color:"#10B981"}),Inactive:e.jsx(D,{size:16,color:"#6B7280"}),Maintenance:e.jsx(we,{size:16,color:"#F59E0B"}),Decommissioned:e.jsx(D,{size:16,color:"#EF4444"})},Y={Active:"green",Inactive:"gray",Maintenance:"amber",Decommissioned:"red"},Ue={Pending:"amber",Approved:"green",Rejected:"red",Decommissioned:"gray"},Xe=()=>{const r=fe(),[a,s]=g.useState(!1),[t,c]=g.useState(null),{data:n,isLoading:m,error:y,mutate:d}=be("Sensor Gateway",{fields:["name","location","status","number_of_transmissions","last_heartbeat","approval_status"]}),p=(o,l)=>{c({message:o,type:l,show:!0})},v=()=>{c(null)},w=()=>I(void 0,null,function*(){s(!0);try{yield d(),p("Gateways refreshed successfully","success")}catch(o){console.error("Error refreshing gateways:",o),p("Failed to refresh gateways","error")}finally{s(!1)}}),f=()=>!n||n.length===0?e.jsx(z,{mt:"4",style:{background:"var(--gray-2)",border:"1px dashed var(--gray-6)",boxShadow:"none"},children:e.jsxs(i,{direction:"column",align:"center",gap:"3",py:"6",children:[e.jsx(u,{style:{opacity:.6},children:e.jsx(P,{size:32,color:"var(--gray-9)"})}),e.jsx(h,{color:"gray",size:"3",weight:"medium",children:"No gateways found"}),e.jsx(A,{variant:"soft",onClick:w,disabled:a,style:{borderRadius:"8px",transition:"all 0.2s ease"},children:e.jsxs(i,{align:"center",gap:"2",children:[e.jsx(N,{size:14,className:a?"animate-spin":""}),"Refresh"]})})]})}):e.jsx(Z,{columns:{initial:"1",sm:"2",md:"3"},gap:"4",mt:"4",children:n.map(o=>{var l,x;return e.jsxs(z,{style:{transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"pointer",borderLeft:`4px solid var(--${Y[o.status]}-9)`,borderRadius:"12px",background:"var(--color-surface)",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.05), 0 1px 2px rgba(0, 0, 0, 0.1)",position:"relative",overflow:"hidden"},className:"hover:shadow-lg hover:translate-y-[-4px] hover:border-opacity-80",onClick:()=>r(`/settings/gateways/${o.name}`),onMouseEnter:j=>{j.currentTarget.style.boxShadow="0 10px 25px rgba(0, 0, 0, 0.1), 0 4px 10px rgba(0, 0, 0, 0.05)"},onMouseLeave:j=>{j.currentTarget.style.boxShadow="0 1px 3px rgba(0, 0, 0, 0.05), 0 1px 2px rgba(0, 0, 0, 0.1)"},children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:"2px",opacity:.8}}),e.jsxs(i,{direction:"column",gap:"3",p:"1",children:[e.jsxs(i,{justify:"between",align:"center",children:[e.jsxs(i,{align:"center",gap:"3",children:[e.jsx(u,{style:{padding:"8px",borderRadius:"8px",background:"var(--gray-3)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(P,{size:18,color:"var(--gray-11)"})}),e.jsxs(u,{children:[e.jsx(h,{size:"1",color:"gray",weight:"medium",style:{letterSpacing:"0.5px"},children:"GATEWAY"}),e.jsx(F,{size:"3",style:{marginTop:"2px"},children:o.location})]})]}),e.jsx($,{color:Ue[o.approval_status],variant:"soft",style:{borderRadius:"20px",padding:"4px 10px",fontSize:"11px",fontWeight:"500",letterSpacing:"0.3px"},children:o.approval_status})]}),e.jsx(u,{style:{height:"1px",background:"var(--gray-5)",margin:"4px 0"}}),e.jsxs(i,{direction:"column",gap:"3",children:[e.jsxs(i,{align:"center",justify:"between",children:[e.jsx(h,{size:"2",color:"gray",weight:"medium",children:"Status"}),e.jsxs(i,{align:"center",gap:"2",children:[e.jsx(h,{size:"2",weight:"medium",style:{color:`var(--${Y[o.status]}-11)`,textTransform:"capitalize"},children:o.status}),e.jsx(u,{style:{display:"flex",alignItems:"center"},children:Oe[o.status]})]})]}),e.jsxs(i,{align:"center",justify:"between",children:[e.jsx(h,{size:"2",color:"gray",weight:"medium",children:"Transmissions"}),e.jsx(u,{style:{background:"var(--gray-3)",padding:"2px 8px",borderRadius:"12px"},children:e.jsx(h,{size:"2",weight:"bold",children:(x=(l=o.number_of_transmissions)==null?void 0:l.toLocaleString())!=null?x:"N/A"})})]}),e.jsxs(i,{direction:"column",gap:"1",children:[e.jsx(h,{size:"2",color:"gray",weight:"medium",children:"Last Heartbeat"}),e.jsx(h,{size:"2",weight:"medium",style:{fontFamily:"var(--font-mono, monospace)",fontSize:"11px",background:o.last_heartbeat?"var(--green-2)":"var(--gray-3)",padding:"4px 6px",borderRadius:"4px",color:o.last_heartbeat?"var(--green-11)":"var(--gray-11)"},children:o.last_heartbeat?new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}).format(new Date(o.last_heartbeat)):"Unavailable"})]})]})]})]},o.name)})});return e.jsxs(u,{p:{initial:"3",sm:"4",md:"6"},style:{background:"var(--gray-1)"},children:[(t==null?void 0:t.show)&&e.jsx(He,{message:t.message,type:t.type,onClose:v}),e.jsx(u,{style:{background:"white",borderBottom:"1px solid var(--gray-6)",top:0,zIndex:10,margin:window.innerWidth<768?"-12px -12px 16px":"-24px -24px 20px",padding:window.innerWidth<768?"16px":"24px",borderRadius:window.innerWidth<768?"0":"0 0 12px 12px"},children:e.jsxs(i,{justify:"between",align:"center",gap:"3",children:[e.jsxs(i,{align:"center",gap:"3",style:{minWidth:0,flex:1},children:[e.jsx(P,{size:window.innerWidth<768?20:24,color:"var(--blue-9)"}),e.jsx(F,{size:{initial:"4",sm:"6"},weight:"bold",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:"Gateways"}),n&&n.length>0&&e.jsxs($,{variant:"soft",color:"blue",size:"2",style:{fontSize:window.innerWidth<768?"11px":"12px"},children:[n.length," Total"]})]}),e.jsx(i,{gap:"2",align:"center",style:{flexShrink:0},children:e.jsx(A,{variant:"soft",onClick:w,disabled:m||a,size:{initial:"1",sm:"2"},style:{borderRadius:"8px",fontSize:window.innerWidth<768?"11px":"14px"},children:e.jsxs(i,{align:"center",gap:"2",children:[e.jsx(N,{className:m||a?"animate-spin":"",size:window.innerWidth<768?10:12}),e.jsx("span",{style:{display:window.innerWidth<380?"none":"inline"},children:"Refresh"})]})})})]})}),m&&e.jsx(z,{style:{border:"1px solid var(--gray-6)",borderRadius:"12px"},children:e.jsxs(i,{justify:"center",align:"center",py:"8",gap:"3",children:[e.jsx(ve,{className:"animate-spin",size:20,color:"var(--blue-9)",style:{animation:"spin 1s linear infinite"}}),e.jsx(h,{size:"3",weight:"medium",color:"gray",children:"Loading gateways..."})]})}),y&&e.jsx(z,{variant:"surface",mt:"4",style:{border:"1px solid var(--red-6)",borderRadius:"12px",background:"var(--red-2)"},children:e.jsxs(i,{direction:"column",align:"center",gap:"3",py:"6",children:[e.jsx(u,{style:{opacity:.8},children:e.jsx(D,{size:24,color:"var(--red-9)"})}),e.jsx(h,{color:"red",weight:"bold",size:"3",children:"Failed to load gateways"}),e.jsx(h,{color:"red",size:"2",style:{textAlign:"center",maxWidth:"400px"},children:y.message}),e.jsx(A,{variant:"soft",color:"red",onClick:w,disabled:a,style:{borderRadius:"8px"},children:e.jsxs(i,{align:"center",gap:"2",children:[e.jsx(N,{size:14,className:a?"animate-spin":""}),"Retry"]})})]})}),!m&&!y&&f(),e.jsx("style",{children:`
          .animate-spin {
            animation: spin 1s linear infinite;
          }
          
          @keyframes spin {
            from {
              transform: rotate(0deg);
            }
            to {
              transform: rotate(360deg);
            }
          }

          /* Mobile-specific optimizations */
          @media (max-width: 767px) {
            /* Ensure proper touch targets */
            button {
              min-height: 44px;
            }
            
            /* Optimize spacing for mobile */
            [data-radix-themes] {
              --space-3: 12px;
              --space-4: 16px;
            }

            /* Card hover effects only on desktop */
            .hover\\:shadow-lg:hover {
              box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05), 0 1px 2px rgba(0, 0, 0, 0.1) !important;
              transform: none !important;
            }
          }
          
          @media (max-width: 479px) {
            /* Extra small screens */
            [data-radix-themes] {
              --space-3: 8px;
              --space-4: 12px;
            }
          }

          @media (max-width: 380px) {
            /* Very small screens - additional optimizations */
            .gateway-card {
              padding: 8px !important;
            }
          }
        `})]})},Ke=({message:r,type:a,onClose:s})=>(g.useEffect(()=>{const t=setTimeout(()=>{s()},5e3);return()=>clearTimeout(t)},[s]),e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
          @keyframes slideIn {
            from {
              transform: translateX(100%);
              opacity: 0;
            }
            to {
              transform: translateX(0);
              opacity: 1;
            }
          }
        `}),e.jsxs("div",{style:{position:"fixed",bottom:"20px",right:"20px",zIndex:1e3,backgroundColor:a==="success"?"var(--green-9)":"var(--red-9)",color:"white",padding:"12px 16px",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)",display:"flex",alignItems:"center",gap:"8px",maxWidth:"300px",animation:"slideIn 0.3s ease-out"},children:[a==="success"?e.jsx(Q,{size:16}):e.jsx(W,{size:16}),e.jsx(h,{size:"2",children:r})]})]})),is=()=>{const{data:r,isLoading:a,error:s,mutate:t}=Se("Cool Track Settings","Cool Track Settings"),{updateDoc:c}=ke(),[n,m]=g.useState({}),[y,d]=g.useState(!1),[p,v]=g.useState(null),w=()=>I(void 0,null,function*(){try{yield c("Cool Track Settings","Cool Track Settings",n),t(),d(!1),f("Settings saved successfully","success")}catch(x){console.error("Error saving settings:",x),f("Failed to save settings. Please try again.","error")}}),f=(x,j)=>{v({message:x,type:j,show:!0})},o=()=>{v(null)},l=x=>n[x]!==void 0?n[x]:r==null?void 0:r[x];return g.useEffect(()=>{const x=j=>{j.ctrlKey&&j.key==="s"&&(j.preventDefault(),w())};return window.addEventListener("keydown",x),()=>{window.removeEventListener("keydown",x)}},[]),a?e.jsx(i,{align:"center",justify:"center",children:e.jsx(i,{direction:"column",align:"center",gap:"4",children:e.jsx(Ce,{size:"3"})})}):s?e.jsx(i,{align:"center",justify:"center",children:e.jsxs(i,{direction:"column",align:"center",gap:"4",children:[e.jsx(W,{size:32,color:"var(--red-9)"}),e.jsx(h,{size:"3",color:"red",children:"Failed to load settings"})]})}):e.jsxs(u,{style:{background:"var(--gray-1)"},children:[(p==null?void 0:p.show)&&e.jsx(Ke,{message:p.message,type:p.type,onClose:o}),e.jsx(u,{style:{background:"white",borderBottom:"1px solid var(--gray-6)"},children:e.jsx(i,{justify:"between",align:"center",p:"6",children:e.jsxs(i,{align:"center",gap:"3",children:[e.jsx(U,{size:24,color:"var(--blue-9)"}),e.jsx(F,{size:"6",weight:"bold",children:"Settings"})]})})}),e.jsx(u,{p:"6",children:e.jsxs(Ie,{defaultValue:"general",children:[e.jsxs(Pe,{size:"2",style:{marginBottom:"24px"},children:[e.jsx(K,{value:"general",children:e.jsxs(i,{align:"center",gap:"2",children:[e.jsx(U,{size:14}),"General Settings"]})}),e.jsx(K,{value:"gateways",children:e.jsxs(i,{align:"center",gap:"2",children:[e.jsx(_e,{size:14}),"Locations"]})})]}),e.jsx(V,{value:"general",children:e.jsx(u,{style:{maxWidth:"800px"},children:e.jsxs(i,{direction:"column",gap:"6",children:[e.jsx(z,{size:"3",style:{border:"1px solid var(--gray-6)"},children:e.jsxs(i,{direction:"column",gap:"5",children:[e.jsx(L,{title:"API Configuration",icon:e.jsx(Re,{}),description:"The endpoint for sensor data reception"}),e.jsx(C,{label:"API Endpoint URL",description:"The complete URL where sensor data will be sent",fullWidth:!0,children:e.jsx(Ae,{value:l("api_url")||"",placeholder:"https://example.com/api/method/receive_sensor_data",size:"3",readOnly:!0,style:{backgroundColor:"var(--gray-2)",cursor:"not-allowed",opacity:.7}})})]})}),e.jsx(z,{size:"3",style:{border:"1px solid var(--gray-6)"},children:e.jsxs(i,{direction:"column",gap:"5",children:[e.jsx(L,{title:"Security & Approval",icon:e.jsx(Te,{}),description:"Control how new devices are approved and managed"}),e.jsx(C,{label:"Location Approval Required",description:"New locations must be manually approved before connecting",badge:l("require_gateway_approval")?"Enabled":"Disabled",badgeColor:l("require_gateway_approval")?"green":"gray",children:e.jsx(_,{size:"2",checked:l("require_gateway_approval"),disabled:!0,style:{cursor:"not-allowed",opacity:.7}})}),e.jsx(X,{size:"4"}),e.jsx(C,{label:"Sensor Approval Required",description:"New sensors must be approved before sending data",badge:l("require_sensor_approval")?"Enabled":"Disabled",badgeColor:l("require_sensor_approval")?"green":"gray",children:e.jsx(_,{size:"2",checked:l("require_sensor_approval"),disabled:!0,style:{cursor:"not-allowed",opacity:.7}})}),e.jsx(X,{size:"4"}),e.jsx(C,{label:"Log Approval Activities",description:"Generate detailed audit logs for all approval activities",badge:l("log_approval_activities")?"Active":"Inactive",badgeColor:l("log_approval_activities")?"blue":"gray",children:e.jsx(_,{size:"2",checked:l("log_approval_activities"),disabled:!0,style:{cursor:"not-allowed",opacity:.7}})})]})}),e.jsx(z,{size:"3",style:{border:"1px solid var(--gray-6)"},children:e.jsxs(i,{direction:"column",gap:"5",children:[e.jsx(L,{title:"Notifications",icon:e.jsx(Ee,{}),description:"Configure email notifications for system events"}),e.jsx(C,{label:"Approval Notifications",description:"Send email notifications when devices require approval",badge:l("send_approval_notifications")?"Enabled":"Disabled",badgeColor:l("send_approval_notifications")?"green":"gray",children:e.jsx(_,{size:"2",checked:l("send_approval_notifications"),disabled:!0,style:{cursor:"not-allowed",opacity:.7}})})]})})]})})}),e.jsx(V,{value:"gateways",children:e.jsx(u,{children:e.jsx(Xe,{})})})]})})]})},L=({title:r,icon:a,description:s})=>e.jsxs(i,{direction:"column",gap:"2",children:[e.jsxs(i,{gap:"3",align:"center",children:[e.jsx(u,{style:{color:"var(--blue-9)"},children:a}),e.jsx(F,{size:"5",weight:"bold",children:r})]}),s&&e.jsx(h,{size:"2",color:"gray",children:s})]}),C=({label:r,description:a,children:s,fullWidth:t=!1,badge:c,badgeColor:n="gray"})=>e.jsxs(u,{children:[e.jsxs(Z,{columns:t?"1":"2",gap:"5",align:"center",children:[e.jsxs(i,{direction:"column",gap:"2",children:[e.jsxs(i,{align:"center",gap:"2",children:[e.jsx(h,{size:"3",weight:"medium",children:r}),c&&e.jsx($,{size:"1",color:n,variant:"soft",children:c})]}),a&&e.jsx(h,{size:"2",color:"gray",style:{lineHeight:1.5},children:a})]}),!t&&e.jsx(i,{justify:"end",children:s})]}),t&&e.jsx(u,{mt:"3",children:s})]});export{is as default};
