var u=(s,c,r)=>new Promise((d,o)=>{var h=i=>{try{n(r.next(i))}catch(a){o(a)}},l=i=>{try{n(r.throw(i))}catch(a){o(a)}},n=i=>i.done?d(i.value):Promise.resolve(i.value).then(h,l);n((r=r.apply(s,c)).next())});import{c as g,w as v,r as y,j as e,p as t,b as w,o as j,L as F,ag as b,s as z,ah as I,d as D}from"./index-X4KS0kgS.js";import{m as L,d as _,P as p,f as x,b as k,T as m}from"./table-DsyRdIWN.js";import{o as C}from"./card-CA4iMPDQ.js";import{p as f}from"./text-fCUYU7-V.js";import"./index-o7eMGu49.js";const $=()=>{const{data:s,isLoading:c,error:r,mutate:d}=g("File",{fields:["name","file_name","file_url","creation"],filters:[["folder","=","Home/Invoices"]],orderBy:{field:"creation",order:"desc"}}),{deleteDoc:o}=v(),[h,l]=y.useState(null),n=i=>u(void 0,null,function*(){if(window.confirm("Are you sure you want to delete this invoice?")){l(i);try{yield o("File",i),d()}catch(U){alert("Failed to delete file.")}finally{l(null)}}});return e.jsx(C,{p:"4",m:"4",children:e.jsxs(t,{direction:"column",gap:"4",children:[e.jsxs(t,{justify:"between",align:"center",children:[e.jsx(w,{size:"6",children:"Invoices"}),e.jsx(j,{asChild:!0,variant:"solid",color:"blue",size:"2",children:e.jsxs(F,{to:"/invoices/upload",children:[e.jsx(b,{style:{marginRight:6}}),"Upload Invoices"]})})]}),c?e.jsx(t,{align:"center",justify:"center",p:"6",children:e.jsx(z,{size:"3"})}):r?e.jsxs(f,{color:"red",size:"2",children:["Failed to load invoices: ",r.message]}):!s||s.length===0?e.jsx(f,{size:"2",color:"gray",children:"No invoices uploaded yet."}):e.jsxs(L,{variant:"surface",children:[e.jsx(_,{children:e.jsxs(p,{children:[e.jsx(x,{children:"File Name"}),e.jsx(x,{children:"Uploaded On"}),e.jsx(x,{children:"Actions"})]})}),e.jsx(k,{children:s.map(i=>e.jsxs(p,{children:[e.jsx(m,{children:i.file_name}),e.jsx(m,{children:new Date(i.creation).toLocaleString()}),e.jsx(m,{children:e.jsxs(t,{gap:"2",children:[e.jsx(j,{asChild:!0,variant:"outline",color:"blue",size:"1",children:e.jsx("a",{href:i.file_url,target:"_blank",rel:"noopener noreferrer",children:e.jsx(I,{})})}),e.jsx(j,{onClick:()=>n(i.name),variant:"outline",color:"red",size:"1",disabled:h===i.name,children:e.jsx(D,{})})]})})]},i.name))})]})]})})};export{$ as default};
