var z=(r,l,s)=>new Promise((c,d)=>{var a=i=>{try{h(s.next(i))}catch(x){d(x)}},y=i=>{try{h(s.throw(i))}catch(x){d(x)}},h=i=>i.done?c(i.value):Promise.resolve(i.value).then(a,y);h((s=s.apply(r,l)).next())});import{r as n,E as W,j as e,p as m,l as L,k as w,m as o,n as P,B as R,w as v,x as b,z as E,C as I,L as A,A as $}from"./index-BsqRx7K0.js";import{o as B}from"./card-Cl9jFH-U.js";import{o as f}from"./separator-BoVDTRez.js";import{u as M,c as D}from"./text-field-DqTx62B3.js";const K=r=>/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(r),N=({message:r,type:l,onClose:s})=>(n.useEffect(()=>{const c=setTimeout(()=>{s()},5e3);return()=>clearTimeout(c)},[s]),e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
          @keyframes slideIn {
            from {
              transform: translateX(100%);
              opacity: 0;
            }
            to {
              transform: translateX(0);
              opacity: 1;
            }
          }
        `}),e.jsxs("div",{style:{position:"fixed",bottom:"20px",right:"20px",zIndex:1e3,backgroundColor:l==="success"?"var(--green-9)":"var(--red-9)",color:"white",padding:"12px 16px",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)",display:"flex",alignItems:"center",gap:"8px",maxWidth:"300px",animation:"slideIn 0.3s ease-out"},children:[l==="success"?e.jsx(E,{size:16}):e.jsx($,{size:16}),e.jsx(o,{size:"2",children:r})]})]})),V=()=>{const[r,l]=n.useState(""),[s,c]=n.useState(!1),[d,a]=n.useState(null),[y,h]=n.useState("success"),[i,x]=n.useState(!1),[u,p]=n.useState(""),{call:k}=W("frappe.core.doctype.user.user.reset_password"),C=t=>t.trim()?K(t)?(p(""),!0):(p("Please enter a valid email address"),!1):(p("Email is required"),!1),S=t=>{const g=t.target.value;l(g),u&&p(""),d&&a(null)},j=()=>z(void 0,null,function*(){if(C(r)){a(null),c(!0);try{yield k({user:r}),a("Password reset instructions have been sent to your email."),h("success"),x(!0)}catch(t){let g="There was an error resetting your password. Please try again.";t!=null&&t.message&&(t.message.includes("User not found")?g="No account found with this email address.":t.message.includes("User disabled")?g="This account has been disabled. Please contact support.":g=t.message),a(g),h("error")}finally{c(!1)}}}),T=t=>{t.key==="Enter"&&!s&&r&&j()},F=()=>{x(!1),a(null),j()};return e.jsxs(e.Fragment,{children:[e.jsx(m,{align:"center",justify:"center",style:{overflow:"hidden",minHeight:"100vh"},children:e.jsx(B,{size:"3",style:{width:"100%",maxWidth:420},children:e.jsxs(m,{direction:"column",gap:"4",align:"center",children:[e.jsx("img",{src:L,alt:"Cool Track Logo",style:{height:60,marginBottom:8}}),i?e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{width:"60px",height:"60px",borderRadius:"50%",backgroundColor:"var(--green-3)",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px"},children:e.jsx(E,{size:24,color:"var(--green-9)"})}),e.jsx(w,{size:"6",align:"center",weight:"bold",children:"Check your email"}),e.jsxs(o,{size:"3",align:"center",color:"gray",style:{maxWidth:"320px"},children:["We've sent a password reset link to ",e.jsx("strong",{children:r})]}),e.jsx(f,{size:"4"}),e.jsx(o,{size:"2",align:"center",color:"gray",style:{maxWidth:"300px"},children:"Didn't receive the email? Check your spam folder or try again."}),e.jsx(v,{variant:"outline",color:"blue",size:"3",onClick:F,disabled:s,style:{width:"100%",height:"44px",fontWeight:"500"},children:s?e.jsx(m,{align:"center",gap:"2",children:e.jsx(b,{size:"2"})}):"Resend Email"})]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{size:"6",align:"center",weight:"bold",children:"Forgot your password?"}),e.jsx(o,{size:"3",align:"center",color:"gray",style:{maxWidth:"320px"},children:"No worries! Enter your email address and we'll send you a link to reset your password."}),e.jsx(f,{size:"4"}),e.jsxs(P,{width:"100%",children:[e.jsx(o,{as:"label",size:"2",weight:"medium",color:"gray",children:"Email Address"}),e.jsx(M,{type:"email",placeholder:"you@cooltrack.co",value:r,onChange:S,onKeyPress:T,size:"3",mt:"2",color:u?"red":void 0,style:{paddingLeft:"10px",border:u?"1px solid var(--red-8)":void 0},children:e.jsx(D,{side:"left",children:e.jsx(R,{size:14,color:"var(--gray-9)"})})}),u&&e.jsx(o,{size:"1",color:"red",mt:"1",children:u})]}),e.jsx(v,{variant:"solid",color:"blue",size:"3",onClick:j,disabled:s||!r,style:{width:"100%",height:"44px",fontWeight:"500"},children:s?e.jsx(m,{align:"center",gap:"2",children:e.jsx(b,{size:"2"})}):"Send Reset Link"})]}),e.jsx(f,{size:"4"}),e.jsxs(m,{align:"center",justify:"center",gap:"2",children:[e.jsx(I,{size:12,color:"var(--gray-9)"}),e.jsx(A,{to:"/login",style:{textDecoration:"none"},children:e.jsx(o,{size:"2",color:"blue",weight:"medium",style:{cursor:"pointer"},children:"Back to Login"})})]})]})})}),d&&e.jsx(N,{message:d,type:y,onClose:()=>a(null)})]})};export{V as default};
