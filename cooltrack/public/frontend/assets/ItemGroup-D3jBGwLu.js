var C=(d,g,a)=>new Promise((u,h)=>{var f=r=>{try{c(a.next(r))}catch(i){h(i)}},y=r=>{try{c(a.throw(r))}catch(i){h(i)}},c=r=>r.done?u(r.value):Promise.resolve(r.value).then(f,y);c((a=a.apply(d,g)).next())});import{c as V,w as X,y as Y,r as t,j as e,p as n,b as Z,o as l,F as ee,s as se,d as te}from"./index-X4KS0kgS.js";import{m as re,d as ne,P as B,f as L,b as oe,T as W}from"./table-DsyRdIWN.js";import{S as ae}from"./SortByDropdown-BIn9PZqH.js";import{o as ie}from"./card-CA4iMPDQ.js";import{s as P,n as le,p as Q,g as R,m as _,D as q}from"./dialog-BIPX10Di.js";import{u as H}from"./text-field-CI2Gm0u8.js";import{p as A}from"./text-fCUYU7-V.js";import"./index-o7eMGu49.js";const fe=()=>{const{data:d,isLoading:g,error:a,mutate:u}=V("Item Group",{fields:["name","creation"],orderBy:{field:"creation",order:"desc"}}),{deleteDoc:h}=X(),{createDoc:f}=Y(),[y,c]=t.useState(null),[r,i]=t.useState(!1),[m,b]=t.useState(null),[J,v]=t.useState(!1),[z,F]=t.useState(""),[E,p]=t.useState(null),[N,G]=t.useState(!1),[I,K]=t.useState("creation"),[w,$]=t.useState("desc"),[k,O]=t.useState(""),M=()=>C(void 0,null,function*(){if(m){c(m);try{yield h("Item Group",m),u()}catch(s){alert("Failed to delete Item Group.")}finally{c(null),b(null),i(!1)}}}),U=()=>C(void 0,null,function*(){G(!0),p(null);const s=z.trim();if(!s){p("Item Group name cannot be empty."),G(!1);return}try{yield f("Item Group",{item_group_name:s}),v(!1),F(""),u()}catch(o){const x=(o==null?void 0:o.message)||"",j=(o==null?void 0:o.exception)||"";x.includes("Duplicate")||j.includes("DuplicateEntryError")?p("An Item Group with this name already exists."):p("Failed to create Item Group.")}finally{G(!1)}}),S=d==null?void 0:d.filter(s=>s.name.toLowerCase().includes(k.toLowerCase())),D=S==null?void 0:S.sort((s,o)=>{const x=s[I],j=o[I],T=x<j?-1:x>j?1:0;return w==="asc"?T:-T});return e.jsxs(ie,{p:"4",m:"4",children:[e.jsxs(n,{direction:"column",gap:"4",children:[e.jsxs(n,{justify:"between",align:"center",children:[e.jsx(Z,{size:"6",children:"Item Groups"}),e.jsxs(P,{open:J,onOpenChange:v,children:[e.jsx(le,{children:e.jsxs(l,{variant:"solid",color:"blue",size:"2",children:[e.jsx(ee,{style:{marginRight:6}}),"Add Item Group"]})}),e.jsxs(Q,{style:{maxWidth:400},children:[e.jsx(R,{children:"Add a New Item Group"}),e.jsx(_,{size:"2",children:"Enter the name of the new Item Group."}),e.jsxs(n,{direction:"column",gap:"3",mt:"4",children:[e.jsx(H,{placeholder:"Item Group Name",value:z,onChange:s=>F(s.target.value)}),E&&e.jsx(A,{color:"red",size:"1",children:E})]}),e.jsxs(n,{gap:"3",mt:"4",justify:"end",children:[e.jsx(q,{children:e.jsx(l,{variant:"soft",color:"gray",children:"Cancel"})}),e.jsx(l,{onClick:U,disabled:N,children:N?"Adding...":"Add Item Group"})]})]})]})]}),e.jsx(n,{direction:"column",gap:"4",children:e.jsxs(n,{justify:"space-between",align:"start",gap:"3",style:{width:"100%"},children:[e.jsx(H,{placeholder:"Search Item Group",value:k,onChange:s=>O(s.target.value),clearable:!0,onClear:()=>O(""),style:{flexGrow:1,minWidth:200,height:36}}),e.jsxs(n,{direction:"row",align:"start",gap:"2",children:[e.jsx(ae,{sortField:I,setSortField:K,setSortOrder:$}),e.jsx(l,{variant:"soft",color:"gray",onClick:()=>$(w==="asc"?"desc":"asc"),size:"2",style:{height:36,padding:"0 12px"},children:w==="asc"?"Ascending":"Descending"})]})]})}),g?e.jsx(n,{align:"center",justify:"center",p:"6",children:e.jsx(se,{size:"3"})}):a?e.jsxs(A,{color:"red",size:"2",children:["Failed to load Item Groups: ",a.message]}):!D||D.length===0?e.jsx(A,{size:"2",color:"gray",children:"No Item Groups found."}):e.jsxs(re,{variant:"surface",children:[e.jsx(ne,{children:e.jsxs(B,{children:[e.jsx(L,{children:"Name"}),e.jsx(L,{children:"Actions"})]})}),e.jsx(oe,{children:D.map(s=>e.jsxs(B,{children:[e.jsx(W,{children:s.name}),e.jsx(W,{children:e.jsx(l,{onClick:()=>{b(s.name),i(!0)},variant:"outline",color:"red",size:"1",disabled:y===s.name,children:e.jsx(te,{})})})]},s.name))})]})]}),e.jsx(P,{open:r,onOpenChange:i,children:e.jsxs(Q,{style:{maxWidth:400},children:[e.jsx(R,{children:"Confirm Delete"}),e.jsxs(_,{children:["Are you sure you want to delete Item Group ",e.jsx("strong",{children:m}),"?"]}),e.jsxs(n,{mt:"4",justify:"end",gap:"3",children:[e.jsx(q,{children:e.jsx(l,{variant:"soft",color:"gray",children:"Cancel"})}),e.jsx(l,{onClick:M,color:"red",disabled:!m,children:"Delete"})]})]})})]})};export{fe as default};
