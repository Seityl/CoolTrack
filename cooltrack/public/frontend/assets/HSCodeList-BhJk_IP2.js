var Fe=Object.defineProperty,ze=Object.defineProperties;var Le=Object.getOwnPropertyDescriptors;var ce=Object.getOwnPropertySymbols;var Oe=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable;var le=(a,r,i)=>r in a?Fe(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,x=(a,r)=>{for(var i in r||(r={}))Oe.call(r,i)&&le(a,i,r[i]);if(ce)for(var i of ce(r))ke.call(r,i)&&le(a,i,r[i]);return a},E=(a,r)=>ze(a,Le(r));var F=(a,r,i)=>new Promise((z,g)=>{var w=f=>{try{j(i.next(f))}catch(C){g(C)}},H=f=>{try{j(i.throw(f))}catch(C){g(C)}},j=f=>f.done?z(f.value):Promise.resolve(f.value).then(w,H);j((i=i.apply(a,r)).next())});import{r as t,c as Ne,w as Ie,y as Pe,g as Me,j as e,p as c,b as Re,o as d,F as We,s as b,e as $e,d as Ve}from"./index-X4KS0kgS.js";import{m as qe,d as Be,P as de,f as u,b as Qe,T as h}from"./table-DsyRdIWN.js";import{P as Ue,R as Ge,T as Je,V as Ke}from"./index-ByvXj5_F.js";import{S as Xe}from"./SortByDropdown-BIn9PZqH.js";import{o as Ye}from"./card-CA4iMPDQ.js";import{s as q,n as Ze,p as B,g as Q,D as U,m as ue}from"./dialog-BIPX10Di.js";import{p as G}from"./text-fCUYU7-V.js";import{u as J}from"./text-field-CI2Gm0u8.js";import"./index-o7eMGu49.js";import"./index-DBV7CZlc.js";const us=()=>{const[a,r]=t.useState([]),[i,z]=t.useState(20),[g,w]=t.useState(!1),[H,j]=t.useState(null),[f,C]=t.useState(!1),[he,L]=t.useState(!1),[fe,O]=t.useState(!1),[_,K]=t.useState(null),[X,v]=t.useState(null),[Y,k]=t.useState(!1),[Z,N]=t.useState(!1),[I,ee]=t.useState(""),[P,pe]=t.useState("tariff_number"),[M,se]=t.useState("asc"),D={tariff_number:"",description:"",custom_precision:"",custom_markup_percentage:"",custom_surcharge_percentage:"",custom_excise_percentage:"",custom_duty_percentage:"",custom_vat_percentage:"15",custom_service_charge_percentage:""},[R,te]=t.useState(x({},D)),[W,$]=t.useState(x({},D)),[xe,re]=t.useState(!1),[me,ge]=t.useState(""),[je,Ce]=t.useState("success"),Se=(s,n)=>{te(l=>E(x({},l),{[s]:n}))},_e=(s,n)=>{$(l=>E(x({},l),{[s]:n}))},ie=(s,n,l=!1)=>e.jsx(c,{direction:"row",wrap:"wrap",gap:"4",mt:"4",children:Object.entries(s).map(([o,p])=>e.jsx(c,{direction:"column",style:{flex:"1 1 45%",minWidth:250},children:l&&o==="tariff_number"?e.jsx(J,{placeholder:ne(o),value:p,readOnly:!0,disabled:!0}):e.jsx(J,{placeholder:ne(o),value:p,onChange:m=>n(o,m.target.value),type:o.includes("percentage")||o.includes("precision")?"number":"text"})},o))}),ne=s=>s.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()),{data:T,error:ae,mutate:A}=Ne("Customs Tariff Number",{fields:["tariff_number","description","custom_precision","custom_markup_percentage","custom_surcharge_percentage","custom_excise_percentage","custom_duty_percentage","custom_vat_percentage","custom_service_charge_percentage"],limit:i,offset:a.length}),{deleteDoc:ye}=Ie(),{createDoc:be}=Pe(),{updateDoc:we}=Me(),He=s=>{K(s),O(!0)},ve=()=>F(void 0,null,function*(){if(_){j(_);try{yield ye("Customs Tariff Number",_),A(),S("HS Code deleted successfully.","success")}catch(s){S("Failed to delete HS Code.","error")}finally{j(null),K(null),O(!1)}}}),De=()=>F(void 0,null,function*(){var p;k(!0),v(null);const{tariff_number:s,description:n,custom_precision:l,custom_vat_percentage:o}=R;if(!s.trim()||!n.trim()||!l||!o){v("Please fill in all required fields."),k(!1);return}try{yield be("Customs Tariff Number",E(x({},R),{name:s.trim()})),te(x({},D)),C(!1),r([]),A(),S("HS Code added successfully.","success")}catch(m){(p=m==null?void 0:m.message)!=null&&p.includes("exists")?v("An HS Code with this tariff number already exists."):v("Failed to create HS Code."),S("Failed to add HS Code.","error")}finally{k(!1)}}),Te=()=>F(void 0,null,function*(){N(!0);const{tariff_number:s,description:n,custom_precision:l,custom_vat_percentage:o}=W;if(!s.trim()||!n.trim()||!l||!o){alert("Please fill in all required fields."),N(!1);return}try{yield we("Customs Tariff Number",s,x({},W)),$(x({},D)),L(!1),r([]),A(),S("HS Code updated successfully.","success")}catch(p){S("Failed to update HS Code.","error")}finally{N(!1)}}),S=(s,n)=>{ge(s),Ce(n),re(!0)},V=a.filter(s=>s.tariff_number.toLowerCase().includes(I.toLowerCase())||s.description.toLowerCase().includes(I.toLowerCase())),y=V==null?void 0:V.sort((s,n)=>{var m,oe;const l=(m=s[P])!=null?m:"",o=(oe=n[P])!=null?oe:"",p=l<o?-1:l>o?1:0;return M==="asc"?p:-p}),Ae=()=>{w(!0),A({limit:i,offset:a.length})},Ee=s=>{$(s),L(!0)};return t.useEffect(()=>{T&&Array.isArray(T)&&r(s=>[...s,...T]),w(!1)},[T]),e.jsxs(Ue,{swipeDirection:"right",children:[e.jsx(Ye,{p:"4",m:"4",children:e.jsxs(c,{direction:"column",gap:"4",children:[e.jsxs(c,{justify:"between",align:"center",children:[e.jsx(Re,{size:"6",children:"HS Codes"}),e.jsxs(q,{open:f,onOpenChange:C,children:[e.jsx(Ze,{children:e.jsxs(d,{variant:"solid",color:"blue",size:"2",children:[e.jsx(We,{style:{marginRight:6}}),"Add HS Code"]})}),e.jsxs(B,{style:{maxWidth:800},children:[e.jsx(Q,{children:"Add a New HS Code"}),ie(R,Se),X&&e.jsx(G,{color:"red",children:X}),e.jsxs(c,{gap:"3",mt:"4",justify:"end",children:[e.jsx(U,{children:e.jsx(d,{variant:"soft",color:"gray",children:"Cancel"})}),e.jsx(d,{variant:"solid",color:"blue",onClick:De,disabled:Y,children:Y?e.jsx(b,{size:"small"}):"Add HS Code"})]})]})]}),e.jsx(q,{open:he,onOpenChange:L,children:e.jsxs(B,{style:{maxWidth:800},children:[e.jsx(Q,{children:"Edit HS Code"}),e.jsx(ue,{size:"2",children:"Modify the fields for this HS Code (Tariff Number cannot be changed)."}),ie(W,_e,!0),e.jsxs(c,{gap:"3",mt:"4",justify:"end",children:[e.jsx(U,{children:e.jsx(d,{variant:"soft",color:"gray",children:"Cancel"})}),e.jsx(d,{variant:"solid",color:"blue",onClick:Te,disabled:Z,children:Z?e.jsx(b,{size:"small"}):"Update HS Code"})]})]})})]}),e.jsx(c,{direction:"column",gap:"4",children:e.jsxs(c,{justify:"space-between",align:"start",gap:"3",style:{width:"100%"},children:[e.jsx(J,{placeholder:"Search HS Codes",value:I,onChange:s=>ee(s.target.value),clearable:!0,onClear:()=>ee(""),style:{flexGrow:1,minWidth:200,height:36}}),e.jsxs(c,{direction:"row",align:"start",gap:"2",children:[e.jsx(Xe,{sortField:P,setSortField:pe,setSortOrder:se}),e.jsx(d,{variant:"soft",color:"gray",onClick:()=>se(M==="asc"?"desc":"asc"),size:"2",style:{height:36,padding:"0 12px"},children:M==="asc"?"Ascending":"Descending"})]})]})}),g?e.jsx(c,{align:"center",justify:"center",p:"6",children:e.jsx(b,{size:"3"})}):ae?e.jsxs(G,{color:"red",size:"2",children:["Failed to load HS Codes: ",ae.message]}):!y||y.length===0?e.jsx(G,{size:"2",color:"gray",children:"No HS Codes found."}):e.jsxs(e.Fragment,{children:[e.jsxs(qe,{variant:"surface",children:[e.jsx(Be,{children:e.jsxs(de,{children:[e.jsx(u,{children:"Tariff Number"}),e.jsx(u,{children:"Precision"}),e.jsx(u,{children:"Description"}),e.jsx(u,{children:"Markup %"}),e.jsx(u,{children:"Surcharge %"}),e.jsx(u,{children:"Excise %"}),e.jsx(u,{children:"Duty %"}),e.jsx(u,{children:"VAT %"}),e.jsx(u,{children:"Service Charge %"}),e.jsx(u,{children:"Actions"})]})}),e.jsx(Qe,{children:y==null?void 0:y.map((s,n)=>e.jsxs(de,{children:[e.jsx(h,{children:s.tariff_number}),e.jsx(h,{children:s.custom_precision}),e.jsx(h,{children:s.description}),e.jsx(h,{children:s.custom_markup_percentage}),e.jsx(h,{children:s.custom_surcharge_percentage}),e.jsx(h,{children:s.custom_excise_percentage}),e.jsx(h,{children:s.custom_duty_percentage}),e.jsx(h,{children:s.custom_vat_percentage}),e.jsx(h,{children:s.custom_service_charge_percentage}),e.jsxs(h,{children:[e.jsx(d,{variant:"outline",color:"blue",onClick:()=>Ee(s),children:e.jsx($e,{})}),e.jsx(d,{variant:"outline",color:"red",onClick:()=>He(s.tariff_number),disabled:H===s.tariff_number,children:H===s.tariff_number?e.jsx(b,{size:"small"}):e.jsx(Ve,{})})]})]},n))})]}),e.jsx(c,{gap:"3",justify:"end",mt:"4",children:[20,50,100,500].map(s=>e.jsx(d,{variant:"outline",color:"blue",onClick:()=>z(s),children:s},s))}),e.jsx(c,{justify:"center",mt:"4",children:e.jsx(d,{onClick:Ae,disabled:g,children:g?e.jsx(b,{size:"small"}):"Load More"})})]})]})}),e.jsx(q,{open:fe,onOpenChange:O,children:e.jsxs(B,{style:{maxWidth:400},children:[e.jsx(Q,{children:"Confirm Delete"}),e.jsxs(ue,{children:["Are you sure you want to delete HS Code ",e.jsx("strong",{children:_}),"?"]}),e.jsxs(c,{mt:"4",justify:"end",gap:"3",children:[e.jsx(U,{children:e.jsx(d,{variant:"soft",color:"gray",children:"Cancel"})}),e.jsx(d,{onClick:ve,color:"red",disabled:!_,children:"Delete"})]})]})}),e.jsx(Ge,{open:xe,onOpenChange:re,duration:3e3,style:{backgroundColor:je==="success"?"var(--green-5)":"var(--red-5)",color:"white",borderRadius:"6px",padding:"12px 16px",fontSize:"14px",position:"fixed",bottom:20,right:20,zIndex:1e3},children:e.jsx(Je,{children:me})}),e.jsx(Ke,{})]})};export{us as default};
