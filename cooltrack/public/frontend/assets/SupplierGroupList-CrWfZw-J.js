var G=(c,m,n)=>new Promise((p,u)=>{var g=s=>{try{o(n.next(s))}catch(l){u(l)}},x=s=>{try{o(n.throw(s))}catch(l){u(l)}},o=s=>s.done?p(s.value):Promise.resolve(s.value).then(g,x);o((n=n.apply(c,m)).next())});import{c as R,w as T,y as W,r as i,j as e,p as t,b as q,o as d,F as H,s as J,d as K}from"./index-X4KS0kgS.js";import{m as M,d as U,P as L,f as k,b as V,T as B}from"./table-DsyRdIWN.js";import{S as X}from"./SortByDropdown-BIn9PZqH.js";import{o as Y}from"./card-CA4iMPDQ.js";import{s as Z,n as ee,p as re,g as se,m as ie,D as te}from"./dialog-BIPX10Di.js";import{u as I}from"./text-field-CI2Gm0u8.js";import{p as C}from"./text-fCUYU7-V.js";import"./index-o7eMGu49.js";const me=()=>{const{data:c,isLoading:m,error:n,mutate:p}=R("Supplier Group",{fields:["name","supplier_group_name","creation"],orderBy:{field:"creation",order:"desc"}}),{deleteDoc:u}=T(),{createDoc:g}=W(),[x,o]=i.useState(null),[s,l]=i.useState(!1),[j,b]=i.useState(""),[v,h]=i.useState(null),[z,f]=i.useState(!1),[S,O]=i.useState("creation"),[y,D]=i.useState("desc"),[F,_]=i.useState(""),P=r=>G(void 0,null,function*(){if(window.confirm("Are you sure you want to delete this supplier group?")){o(r);try{yield u("Supplier Group",r),p()}catch(a){alert("Failed to delete supplier group.")}finally{o(null)}}}),Q=()=>G(void 0,null,function*(){var r;if(f(!0),h(null),!j.trim()){h("Supplier group name cannot be empty."),f(!1);return}try{yield g("Supplier Group",{supplier_group_name:j.trim()}),l(!1),b(""),p()}catch(a){(r=a==null?void 0:a.message)!=null&&r.includes("exists")?h("A supplier group with this name already exists."):h("Failed to create supplier group.")}finally{f(!1)}}),w=c==null?void 0:c.filter(r=>r.supplier_group_name.toLowerCase().includes(F.toLowerCase())),A=w==null?void 0:w.sort((r,a)=>{const N=r[S],E=a[S],$=N<E?-1:N>E?1:0;return y==="asc"?$:-$});return e.jsx(Y,{p:"4",m:"4",children:e.jsxs(t,{direction:"column",gap:"4",children:[e.jsxs(t,{justify:"between",align:"center",children:[e.jsx(q,{size:"6",children:"Supplier Groups"}),e.jsxs(Z,{open:s,onOpenChange:l,children:[e.jsx(ee,{children:e.jsxs(d,{variant:"solid",color:"blue",size:"2",children:[e.jsx(H,{style:{marginRight:6}})," Add Supplier Group"]})}),e.jsxs(re,{style:{maxWidth:400},children:[e.jsx(se,{children:"Add a New Supplier Group"}),e.jsx(ie,{size:"2",children:"Enter the name of the new supplier group."}),e.jsxs(t,{direction:"column",gap:"3",mt:"4",children:[e.jsx(I,{placeholder:"Supplier Group Name",value:j,onChange:r=>b(r.target.value)}),v&&e.jsx(C,{color:"red",size:"1",children:v})]}),e.jsxs(t,{gap:"3",mt:"4",justify:"end",children:[e.jsx(te,{children:e.jsx(d,{variant:"soft",color:"gray",children:"Cancel"})}),e.jsx(d,{onClick:Q,disabled:z,children:z?"Adding...":"Add Supplier Group"})]})]})]})]}),e.jsx(t,{direction:"column",gap:"4",children:e.jsxs(t,{justify:"space-between",align:"start",gap:"3",style:{width:"100%"},children:[e.jsx(I,{placeholder:"Search Supplier Group",value:F,onChange:r=>_(r.target.value),clearable:!0,onClear:()=>_(""),style:{flexGrow:1,minWidth:200,height:36}}),e.jsxs(t,{direction:"row",align:"start",gap:"2",children:[e.jsx(X,{sortField:S,setSortField:O,setSortOrder:D}),e.jsx(d,{variant:"soft",color:"gray",onClick:()=>D(y==="asc"?"desc":"asc"),size:"2",style:{height:36,padding:"0 12px"},children:y==="asc"?"Ascending":"Descending"})]})]})}),m?e.jsx(t,{align:"center",justify:"center",p:"6",children:e.jsx(J,{size:"3"})}):n?e.jsxs(C,{color:"red",size:"2",children:["Failed to load supplier groups: ",n.message]}):!A||A.length===0?e.jsx(C,{size:"2",color:"gray",children:"No supplier groups found."}):e.jsxs(M,{variant:"surface",children:[e.jsx(U,{children:e.jsxs(L,{children:[e.jsx(k,{children:"Name"}),e.jsx(k,{children:"Actions"})]})}),e.jsx(V,{children:A.map(r=>e.jsxs(L,{children:[e.jsx(B,{children:r.supplier_group_name}),e.jsx(B,{children:e.jsx(d,{onClick:()=>P(r.name),variant:"outline",color:"red",size:"1",disabled:x===r.name,children:e.jsx(K,{})})})]},r.name))})]})]})})};export{me as default};
