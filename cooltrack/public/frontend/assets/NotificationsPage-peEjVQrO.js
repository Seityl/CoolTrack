var u=(g,o,t)=>new Promise((c,d)=>{var i=a=>{try{m(t.next(a))}catch(l){d(l)}},j=a=>{try{m(t.throw(a))}catch(l){d(l)}},m=a=>a.done?c(a.value):Promise.resolve(a.value).then(i,j);m((t=t.apply(g,o)).next())});import{f as k,g as v,E as z,j as e,p as n,s as _,b as h,o as y,M,F as b,m as p,t as N,a as w,c as x}from"./index-C04qYfe-.js";import{o as f}from"./card-C5T3GK1O.js";const $=()=>{var l;const{currentUser:g}=k(),{data:o,isValidating:t,mutate:c}=v("cooltrack.api.v1.get_notifications",{user_email:g}),{call:d}=z("cooltrack.api.v1.update_notification"),i=(l=o==null?void 0:o.message)!=null?l:[],j=s=>u(void 0,null,function*(){try{yield d({notification:s}),c()}catch(r){console.error("Error marking notification as read:",r)}}),m=()=>u(void 0,null,function*(){const s=i.filter(r=>!r.seen);try{yield Promise.all(s.map(r=>d({notification:r.name}))),c()}catch(r){console.error("Error marking all notifications as read:",r)}}),a=()=>{c()};return t?e.jsx(n,{justify:"center",align:"center",className:"h-[60vh]",children:e.jsx(_,{size:"3"})}):e.jsxs(h,{className:"bg-gray-50 px-4 py-6",children:[e.jsx(h,{className:"px-4 w-full bg-white/90 backdrop-blur-sm",style:{position:"sticky",top:0,zIndex:100},children:e.jsxs(n,{gap:"3",justify:"end",align:"center",children:[e.jsxs(y,{variant:"soft",onClick:a,children:[e.jsx(M,{})," Refresh"]}),i.some(s=>!s.seen)&&e.jsxs(y,{variant:"soft",color:"green",onClick:m,children:[e.jsx(b,{})," Mark all as read"]})]})}),e.jsx(h,{className:"px-4 py-6",children:e.jsxs(n,{direction:"column",gap:"6",className:"w-full",children:[e.jsx(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsx(f,{className:"shadow-md w-full bg-white rounded-xl border border-gray-200",children:e.jsxs(n,{gap:"4",align:"center",p:"6",children:[e.jsx("div",{className:"p-3 rounded-full bg-indigo-50",children:e.jsx(N,{size:"24",color:"blue"})}),e.jsxs(n,{direction:"column",children:[e.jsx(w,{size:"5",weight:"bold",className:"text-gray-900",children:"Your Notifications"}),e.jsxs(x,{size:"2",color:"gray",children:[i.length," unread notification",i.length!==1?"s":""]})]})]})})}),e.jsx(n,{direction:"column",gap:"3",className:"w-full",children:i.length>0?i.map((s,r)=>e.jsx(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:r*.05},children:e.jsx(f,{className:`shadow-md w-full transition-all duration-200 hover:shadow-xl ${s.seen?"bg-white":"border-l-4 border-indigo-500 bg-indigo-50/50"}`,children:e.jsx(h,{p:"5",children:e.jsxs(n,{justify:"between",align:"start",gap:"3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`text-md font-semibold mb-1 ${s.seen?"text-gray-700":"text-gray-900"}`,dangerouslySetInnerHTML:{__html:s.subject}}),s.message?e.jsx("div",{className:"text-sm text-gray-600",dangerouslySetInnerHTML:{__html:s.message}}):e.jsx(x,{size:"2",color:"gray",children:"No message content."}),e.jsx(x,{size:"1",color:"gray",mt:"2",className:"italic",children:new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}).format(new Date(s.created_on.replace(" ","T")))})]}),!s.seen&&e.jsxs(y,{size:"1",variant:"soft",color:"indigo",onClick:()=>j(s.name),className:"shrink-0",children:[e.jsx(b,{})," Mark read"]})]})})})},s.name)):e.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:e.jsx(f,{className:"shadow-md w-full bg-white rounded-xl border border-gray-200",children:e.jsxs(h,{p:"6",className:"text-center",children:[e.jsx(N,{size:"24",className:"mx-auto text-gray-300 mb-3"}),e.jsx(w,{size:"4",color:"gray",mb:"2",children:"No notifications yet"}),e.jsx(x,{size:"2",color:"gray",children:"We'll notify you when there's something new."})]})})})})]})})]})};export{$ as default};
