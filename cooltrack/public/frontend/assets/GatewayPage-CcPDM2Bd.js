var $e=Object.defineProperty,Ge=Object.defineProperties;var We=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var J=(a,t,r)=>t in a?$e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,d=(a,t)=>{for(var r in t||(t={}))ee.call(t,r)&&J(a,r,t[r]);if(F)for(var r of F(t))ae.call(t,r)&&J(a,r,t[r]);return a},g=(a,t)=>Ge(a,We(t));var x=(a,t)=>{var r={};for(var o in a)ee.call(a,o)&&t.indexOf(o)<0&&(r[o]=a[o]);if(a!=null&&F)for(var o of F(a))t.indexOf(o)<0&&ae.call(a,o)&&(r[o]=a[o]);return r};var M=(a,t,r)=>new Promise((o,i)=>{var n=u=>{try{c(r.next(u))}catch(p){i(p)}},s=u=>{try{c(r.throw(u))}catch(p){i(p)}},c=u=>u.done?o(u.value):Promise.resolve(u.value).then(n,s);c((r=r.apply(a,t)).next())});import{r as l,j as e,t as ke,U as H,P as z,V as E,W as Le,X as V,Y as Be,Z as Ue,_ as He,$,A as Ve,B as k,a0 as qe,C as ue,a as L,c as D,x as Ye,a1 as Ze,D as Ke,a2 as Qe,u as Xe,R as te,G as Je,E as se,p as m,s as ea,o as w,a3 as re,b as N,i as ne,T as q,F as ge,a4 as B,a5 as v,a6 as oe,a7 as aa,a8 as ta,a9 as sa,Q as U,aa as ra,q as na,ab as ie,ac as le,ad as oa}from"./index-DjJ_UgHu.js";import{p as G}from"./container-DdpQINU3.js";import{o as R}from"./card-CbHK6U27.js";import{u as W}from"./index-qWNBboJE.js";import{u as ia}from"./index-BBS9qKzp.js";import{P as la,R as ca,h as da,u as ua,F as ga}from"./index-BucnSMQm.js";import"./get-subtree-rHMu7h23.js";var Y="Dialog",[pe,Va]=ke(Y),[pa,y]=pe(Y),xe=a=>{const{__scopeDialog:t,children:r,open:o,defaultOpen:i,onOpenChange:n,modal:s=!0}=a,c=l.useRef(null),u=l.useRef(null),[p=!1,h]=ia({prop:o,defaultProp:i,onChange:n});return e.jsx(pa,{scope:t,triggerRef:c,contentRef:u,contentId:W(),titleId:W(),descriptionId:W(),open:p,onOpenChange:h,onOpenToggle:l.useCallback(()=>h(C=>!C),[h]),modal:s,children:r})};xe.displayName=Y;var me="DialogTrigger",fe=l.forwardRef((a,t)=>{const s=a,{__scopeDialog:r}=s,o=x(s,["__scopeDialog"]),i=y(me,r),n=V(t,i.triggerRef);return e.jsx(z.button,g(d({type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":Q(i.open)},o),{ref:n,onClick:E(a.onClick,i.onOpenToggle)}))});fe.displayName=me;var Z="DialogPortal",[xa,je]=pe(Z,{forceMount:void 0}),he=a=>{const{__scopeDialog:t,forceMount:r,children:o,container:i}=a,n=y(Z,t);return e.jsx(xa,{scope:t,forceMount:r,children:l.Children.map(o,s=>e.jsx(H,{present:r||n.open,children:e.jsx(la,{asChild:!0,container:i,children:s})}))})};he.displayName=Z;var T="DialogOverlay",ve=l.forwardRef((a,t)=>{const r=je(T,a.__scopeDialog),s=a,{forceMount:o=r.forceMount}=s,i=x(s,["forceMount"]),n=y(T,a.__scopeDialog);return n.modal?e.jsx(H,{present:o||n.open,children:e.jsx(fa,g(d({},i),{ref:t}))}):null});ve.displayName=T;var ma=Le("DialogOverlay.RemoveScroll"),fa=l.forwardRef((a,t)=>{const n=a,{__scopeDialog:r}=n,o=x(n,["__scopeDialog"]),i=y(T,r);return e.jsx(ca,{as:ma,allowPinchZoom:!0,shards:[i.contentRef],children:e.jsx(z.div,g(d({"data-state":Q(i.open)},o),{ref:t,style:d({pointerEvents:"auto"},o.style)}))})}),b="DialogContent",ye=l.forwardRef((a,t)=>{const r=je(b,a.__scopeDialog),s=a,{forceMount:o=r.forceMount}=s,i=x(s,["forceMount"]),n=y(b,a.__scopeDialog);return e.jsx(H,{present:o||n.open,children:n.modal?e.jsx(ja,g(d({},i),{ref:t})):e.jsx(ha,g(d({},i),{ref:t}))})});ye.displayName=b;var ja=l.forwardRef((a,t)=>{const r=y(b,a.__scopeDialog),o=l.useRef(null),i=V(t,r.contentRef,o);return l.useEffect(()=>{const n=o.current;if(n)return da(n)},[]),e.jsx(De,g(d({},a),{ref:i,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:E(a.onCloseAutoFocus,n=>{var s;n.preventDefault(),(s=r.triggerRef.current)==null||s.focus()}),onPointerDownOutside:E(a.onPointerDownOutside,n=>{const s=n.detail.originalEvent,c=s.button===0&&s.ctrlKey===!0;(s.button===2||c)&&n.preventDefault()}),onFocusOutside:E(a.onFocusOutside,n=>n.preventDefault())}))}),ha=l.forwardRef((a,t)=>{const r=y(b,a.__scopeDialog),o=l.useRef(!1),i=l.useRef(!1);return e.jsx(De,g(d({},a),{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:n=>{var s,c;(s=a.onCloseAutoFocus)==null||s.call(a,n),n.defaultPrevented||(o.current||(c=r.triggerRef.current)==null||c.focus(),n.preventDefault()),o.current=!1,i.current=!1},onInteractOutside:n=>{var u,p;(u=a.onInteractOutside)==null||u.call(a,n),n.defaultPrevented||(o.current=!0,n.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const s=n.target;((p=r.triggerRef.current)==null?void 0:p.contains(s))&&n.preventDefault(),n.detail.originalEvent.type==="focusin"&&i.current&&n.preventDefault()}}))}),De=l.forwardRef((a,t)=>{const h=a,{__scopeDialog:r,trapFocus:o,onOpenAutoFocus:i,onCloseAutoFocus:n}=h,s=x(h,["__scopeDialog","trapFocus","onOpenAutoFocus","onCloseAutoFocus"]),c=y(b,r),u=l.useRef(null),p=V(t,u);return ua(),e.jsxs(e.Fragment,{children:[e.jsx(ga,{asChild:!0,loop:!0,trapped:o,onMountAutoFocus:i,onUnmountAutoFocus:n,children:e.jsx(Be,g(d({role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":Q(c.open)},s),{ref:p,onDismiss:()=>c.onOpenChange(!1)}))}),e.jsxs(e.Fragment,{children:[e.jsx(va,{titleId:c.titleId}),e.jsx(Da,{contentRef:u,descriptionId:c.descriptionId})]})]})}),K="DialogTitle",Ne=l.forwardRef((a,t)=>{const n=a,{__scopeDialog:r}=n,o=x(n,["__scopeDialog"]),i=y(K,r);return e.jsx(z.h2,g(d({id:i.titleId},o),{ref:t}))});Ne.displayName=K;var Ce="DialogDescription",Re=l.forwardRef((a,t)=>{const n=a,{__scopeDialog:r}=n,o=x(n,["__scopeDialog"]),i=y(Ce,r);return e.jsx(z.p,g(d({id:i.descriptionId},o),{ref:t}))});Re.displayName=Ce;var be="DialogClose",we=l.forwardRef((a,t)=>{const n=a,{__scopeDialog:r}=n,o=x(n,["__scopeDialog"]),i=y(be,r);return e.jsx(z.button,g(d({type:"button"},o),{ref:t,onClick:E(a.onClick,()=>i.onOpenChange(!1))}))});we.displayName=be;function Q(a){return a?"open":"closed"}var _e="DialogTitleWarning",[qa,Ee]=Ue(_e,{contentName:b,titleName:K,docsSlug:"dialog"}),va=({titleId:a})=>{const t=Ee(_e),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return l.useEffect(()=>{a&&(document.getElementById(a)||console.error(r))},[r,a]),null},ya="DialogDescriptionWarning",Da=({contentRef:a,descriptionId:t})=>{const o=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${Ee(ya).contentName}}.`;return l.useEffect(()=>{var n;const i=(n=a.current)==null?void 0:n.getAttribute("aria-describedby");t&&i&&(document.getElementById(t)||console.warn(o))},[o,a,t]),null},Na=xe,Ca=fe,Ra=he,ba=ve,wa=ye,_a=Ne,Ea=Re,za=we;const Pa=["1","2","3","4"],Aa=d(g(d({},Ve),{align:{type:"enum",className:"rt-r-align",values:["start","center"],default:"center"},size:{type:"enum",className:"rt-r-size",values:Pa,default:"3",responsive:!0},width:$.width,minWidth:$.minWidth,maxWidth:g(d({},$.maxWidth),{default:"600px"})}),He),ze=a=>{if(!l.isValidElement(a))throw Error(`Expected a single React Element child, but got: ${l.Children.toArray(a).map(t=>typeof t=="object"&&"type"in t&&typeof t.type=="string"?t.type:typeof t).join(", ")}`);return a},Pe=a=>l.createElement(Na,g(d({},a),{modal:!0}));Pe.displayName="Dialog.Root";const Sa=l.forwardRef((o,r)=>{var i=o,{children:a}=i,t=x(i,["children"]);return l.createElement(Ca,g(d({},t),{ref:r,asChild:!0}),ze(a))});Sa.displayName="Dialog.Trigger";const Ae=l.forwardRef((o,r)=>{var i=o,{align:a}=i,t=x(i,["align"]);const P=Aa,{align:n}=P,s=x(P,["align"]),{className:c}=k({align:a},{align:n}),A=k(t,s),{className:u,forceMount:p,container:h}=A,C=x(A,["className","forceMount","container"]);return l.createElement(Ra,{container:h,forceMount:p},l.createElement(qe,{asChild:!0},l.createElement(ba,{className:"rt-BaseDialogOverlay rt-DialogOverlay"},l.createElement("div",{className:"rt-BaseDialogScroll rt-DialogScroll"},l.createElement("div",{className:`rt-BaseDialogScrollPadding rt-DialogScrollPadding ${c}`},l.createElement(wa,g(d({},C),{ref:r,className:ue("rt-BaseDialogContent","rt-DialogContent",u)})))))))});Ae.displayName="Dialog.Content";const Se=l.forwardRef((a,t)=>l.createElement(_a,{asChild:!0},l.createElement(L,g(d({size:"5",mb:"3",trim:"start"},a),{asChild:!1,ref:t}))));Se.displayName="Dialog.Title";const Ie=l.forwardRef((a,t)=>l.createElement(Ea,{asChild:!0},l.createElement(D,g(d({as:"p",size:"3"},a),{asChild:!1,ref:t}))));Ie.displayName="Dialog.Description";const Fe=l.forwardRef((o,r)=>{var i=o,{children:a}=i,t=x(i,["children"]);return l.createElement(za,g(d({},t),{ref:r,asChild:!0}),ze(a))});Fe.displayName="Dialog.Close";const Ia=["1","2","3"],Fa=["classic","surface","soft"],Ta=["none","vertical","horizontal","both"],Oa=d(d({size:{type:"enum",className:"rt-r-size",values:Ia,default:"2",responsive:!0},variant:{type:"enum",className:"rt-variant",values:Fa,default:"surface"},resize:{type:"enum",className:"rt-r-resize",values:Ta,responsive:!0}},Ze),Ye),Te=l.forwardRef((a,t)=>{const c=k(a,Oa,Ke),{className:r,color:o,radius:i,style:n}=c,s=x(c,["className","color","radius","style"]);return l.createElement("div",{"data-accent-color":o,"data-radius":i,className:ue("rt-TextAreaRoot",r),style:n},l.createElement("textarea",d({className:"rt-reset rt-TextAreaInput",ref:t},s)))});Te.displayName="TextArea";const Ma={LTE:e.jsx(oa,{className:"text-blue-500",size:20}),Ethernet:e.jsx(le,{className:"text-purple-500",size:20}),USB:e.jsx(ie,{className:"text-green-500",size:20}),IoT:e.jsx(q,{className:"text-orange-500",size:20}),SS:e.jsx(le,{className:"text-purple-500",size:20}),WSA:e.jsx(ie,{className:"text-green-500",size:20})},ce={Active:{icon:e.jsx(q,{size:14}),color:"green"},Inactive:{icon:e.jsx(U,{size:14}),color:"gray"},Maintenance:{icon:e.jsx(ra,{size:14}),color:"orange"},Decommissioned:{icon:e.jsx(U,{size:14}),color:"red"}},de={Pending:{icon:e.jsx(na,{size:14}),color:"blue"},Approved:{icon:e.jsx(ge,{size:14}),color:"green"},Rejected:{icon:e.jsx(B,{size:14}),color:"red"},Decommissioned:{icon:e.jsx(U,{size:14}),color:"gray"}},Ya=()=>{var X;const{id:a}=Qe(),t=Xe(),[r,o]=te.useState(!1),[i,n]=te.useState(""),{data:s,isLoading:c,error:u,mutate:p}=Je("Sensor Gateway",a),{call:h,loading:C}=se("frappe.client.set_value"),{call:P,loading:A}=se("frappe.client.set_value"),Oe=()=>M(void 0,null,function*(){try{yield h({doctype:"Sensor Gateway",name:s==null?void 0:s.name,fieldname:"approval_status",value:"Approved"}),p()}catch(j){console.error("Failed to approve gateway:",j)}}),Me=()=>M(void 0,null,function*(){try{yield h({doctype:"Sensor Gateway",name:s==null?void 0:s.name,fieldname:"approval_status",value:"Rejected"}),i&&(yield P({doctype:"Sensor Gateway",name:s==null?void 0:s.name,fieldname:"notes",value:`Gateway rejected. Reason: ${i}`})),p(),o(!1),n("")}catch(j){console.error("Failed to reject gateway:",j)}});if(c)return e.jsx(m,{justify:"center",align:"center",className:"h-[60vh]",children:e.jsx(ea,{size:"3"})});if(u||!s)return e.jsx(G,{size:"4",className:"h-[60vh] flex items-center justify-center",children:e.jsx(R,{children:e.jsxs(m,{direction:"column",gap:"4",align:"center",children:[e.jsx(D,{color:"red",weight:"bold",children:"Error loading gateway details"}),e.jsx(D,{children:(u==null?void 0:u.message)||"Gateway not found"}),e.jsxs(w,{onClick:()=>t("/gateways"),children:[e.jsx(re,{})," Return to Gateways"]})]})})});const O=j=>j?new Date(j).toLocaleString():"Not available",_=({title:j,icon:S})=>e.jsxs(m,{gap:"3",align:"center",mb:"2",children:[e.jsx(N,{className:"text-gray-500",children:S}),e.jsx(L,{size:"4",weight:"medium",children:j})]}),f=({label:j,value:S,vertical:I=!1})=>e.jsx(m,{direction:I?"column":"row",align:I?"start":"center",gap:I?"1":"3",py:"2",children:I?e.jsxs(e.Fragment,{children:[e.jsx(D,{size:"1",className:"text-gray-500",children:j}),e.jsx(D,{size:"2",children:S||"—"})]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{weight:"medium",className:"w-40 text-gray-600",children:j}),e.jsx(D,{className:"flex-1",children:S||"—"})]})});return e.jsxs(N,{width:"100%",className:"min-h-screen",children:[e.jsx(N,{className:"bg-white border-b border-gray-200 p-4 sticky top-0 z-10",children:e.jsx(G,{size:"4",children:e.jsxs(m,{justify:"between",align:"center",children:[e.jsxs(w,{variant:"soft",onClick:()=>t("/gateways"),children:[e.jsx(re,{})," All Gateways"]}),e.jsxs(m,{gap:"3",align:"center",children:[e.jsx(ne,{color:ce[s.status].color,highContrast:!0,className:"uppercase",children:e.jsxs(m,{gap:"2",align:"center",children:[ce[s.status].icon,s.status]})}),e.jsx(ne,{color:de[s.approval_status].color,highContrast:!0,className:"uppercase",children:e.jsxs(m,{gap:"2",align:"center",children:[de[s.approval_status].icon,s.approval_status]})})]})]})})}),e.jsx(G,{size:"4",py:"4",children:e.jsx(m,{direction:"column",gap:"4",children:e.jsxs(R,{className:"shadow-sm",children:[e.jsxs(m,{gap:"4",align:"center",p:"4",children:[e.jsx(N,{className:"p-3 bg-gray-50 rounded-lg",children:Ma[s.gateway_type]||e.jsx(q,{size:24})}),e.jsxs(m,{direction:"column",children:[e.jsx(L,{size:"5",weight:"bold",children:s.model_number||s.name}),e.jsxs(D,{color:"gray",size:"2",children:["Serial: ",s.serial_number||"Not specified"]})]})]}),s.approval_status==="Pending"&&e.jsxs(m,{gap:"3",p:"4",justify:"end",children:[e.jsxs(w,{variant:"solid",color:"green",onClick:Oe,disabled:C,children:[e.jsx(ge,{})," Approve"]}),e.jsxs(w,{variant:"soft",color:"red",onClick:()=>o(!0),disabled:C,children:[e.jsx(B,{})," Reject"]})]}),e.jsx(v,{size:"4"}),e.jsxs(m,{direction:"column",gap:"4",p:"4",children:[e.jsxs(N,{children:[e.jsx(_,{title:"Basic Information",icon:e.jsx(oe,{})}),e.jsxs(R,{variant:"surface",children:[e.jsx(f,{label:"Gateway Type",value:s.gateway_type}),e.jsx(v,{size:"1"}),e.jsx(f,{label:"Model",value:s.model_number}),e.jsx(v,{size:"1"}),e.jsx(f,{label:"Serial Number",value:s.serial_number}),e.jsx(v,{size:"1"}),e.jsx(f,{label:"Installed On",value:O(s.installation_date)})]})]}),e.jsxs(N,{children:[e.jsx(_,{title:"Location",icon:e.jsx(aa,{})}),e.jsx(R,{variant:"surface",children:e.jsx(f,{label:"Site Location",value:s.location})})]}),e.jsxs(N,{children:[e.jsx(_,{title:"Connectivity",icon:e.jsx(ta,{})}),e.jsxs(R,{variant:"surface",children:[e.jsx(f,{label:"IP Address",value:s.ip_address}),e.jsx(v,{size:"1"}),e.jsx(f,{label:"MAC Address",value:s.mac_address}),e.jsx(v,{size:"1"}),e.jsx(f,{label:"Network Provider",value:s.network_provider}),e.jsx(v,{size:"1"}),e.jsx(f,{label:"SIM Card",value:s.sim_card_number}),e.jsx(v,{size:"1"}),e.jsx(f,{label:"USB Port",value:s.usb_port})]})]}),e.jsxs(N,{children:[e.jsx(_,{title:"Metadata",icon:e.jsx(sa,{})}),e.jsxs(R,{variant:"surface",children:[e.jsx(f,{label:"Firmware Version",value:s.firmware_version}),e.jsx(v,{size:"1"}),e.jsx(f,{label:"Transmissions",value:(X=s.number_of_transmissions)==null?void 0:X.toLocaleString()}),e.jsx(v,{size:"1"}),e.jsx(f,{label:"Last Maintenance",value:O(s.last_maintenance)}),e.jsx(v,{size:"1"}),e.jsx(f,{label:"Last Heartbeat",value:O(s.last_heartbeat),vertical:!0})]})]}),s.notes&&e.jsxs(N,{children:[e.jsx(_,{title:"Notes",icon:e.jsx(oe,{})}),e.jsx(R,{variant:"surface",children:e.jsx(D,{className:"whitespace-pre-line p-3",children:s.notes})})]})]})]})})}),e.jsx(Pe,{open:r,onOpenChange:o,children:e.jsxs(Ae,{style:{maxWidth:450},children:[e.jsx(Se,{children:"Reject Gateway"}),e.jsx(Ie,{size:"2",mb:"4",children:"Please provide a reason for rejecting this gateway."}),e.jsx(m,{direction:"column",gap:"3",children:e.jsxs("label",{children:[e.jsx(D,{as:"div",size:"2",mb:"1",weight:"bold",children:"Reason"}),e.jsx(Te,{placeholder:"Enter rejection reason...",value:i,onChange:j=>n(j.target.value)})]})}),e.jsxs(m,{gap:"3",mt:"4",justify:"end",children:[e.jsx(Fe,{children:e.jsx(w,{variant:"soft",color:"gray",children:"Cancel"})}),e.jsxs(w,{variant:"solid",color:"red",onClick:Me,disabled:!i||C||A,children:[e.jsx(B,{})," Confirm Reject"]})]})]})})]})};export{Ya as default};
