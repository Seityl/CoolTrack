var Z=Object.defineProperty,ee=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var U=(t,a,s)=>a in t?Z(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,x=(t,a)=>{for(var s in a||(a={}))L.call(a,s)&&U(t,s,a[s]);if(F)for(var s of F(a))H.call(a,s)&&U(t,s,a[s]);return t},b=(t,a)=>ee(t,se(a));var R=(t,a)=>{var s={};for(var o in t)L.call(t,o)&&a.indexOf(o)<0&&(s[o]=t[o]);if(t!=null&&F)for(var o of F(t))a.indexOf(o)<0&&H.call(t,o)&&(s[o]=t[o]);return s};var B=(t,a,s)=>new Promise((o,d)=>{var i=n=>{try{p(s.next(n))}catch(u){d(u)}},c=n=>{try{p(s.throw(n))}catch(u){d(u)}},p=n=>n.done?o(n.value):Promise.resolve(n.value).then(i,c);p((s=s.apply(t,a)).next())});import{r as l,X as te,j as e,t as ae,P as X,V as re,ap as oe,x as ne,y as ie,a1 as ce,B as le,C as D,D as de,G as pe,aq as ue,p as C,s as M,c as w,b as S,o as G,a4 as he,ar as me,a as O,g as xe,a5 as V,as as ge,k as fe,F as ve,d as je}from"./index-DjJ_UgHu.js";import{u as be}from"./index-BBS9qKzp.js";import{u as Ce}from"./index-uTFj2twO.js";import{o as W}from"./card-CbHK6U27.js";import{p as Se}from"./container-DdpQINU3.js";import{o as we}from"./grid-kXYX5S3-.js";import{u as ke}from"./text-field-DYbpgSKD.js";import"./get-subtree-rHMu7h23.js";var I="Switch",[ye,Ge]=ae(I),[_e,Ne]=ye(I),J=l.forwardRef((t,a)=>{const z=t,{__scopeSwitch:s,name:o,checked:d,defaultChecked:i,required:c,disabled:p,value:n="on",onCheckedChange:u,form:g}=z,k=R(z,["__scopeSwitch","name","checked","defaultChecked","required","disabled","value","onCheckedChange","form"]),[f,j]=l.useState(null),E=te(a,m=>j(m)),y=l.useRef(!1),_=f?g||!!f.closest("form"):!0,[v=!1,$]=be({prop:d,defaultProp:i,onChange:u});return e.jsxs(_e,{scope:s,checked:v,disabled:p,children:[e.jsx(X.button,b(x({type:"button",role:"switch","aria-checked":v,"aria-required":c,"data-state":Y(v),"data-disabled":p?"":void 0,disabled:p,value:n},k),{ref:E,onClick:re(t.onClick,m=>{$(N=>!N),_&&(y.current=m.isPropagationStopped(),y.current||m.stopPropagation())})})),_&&e.jsx(Pe,{control:f,bubbles:!y.current,name:o,value:n,checked:v,required:c,disabled:p,form:g,style:{transform:"translateX(-100%)"}})]})});J.displayName=I;var K="SwitchThumb",Q=l.forwardRef((t,a)=>{const i=t,{__scopeSwitch:s}=i,o=R(i,["__scopeSwitch"]),d=Ne(K,s);return e.jsx(X.span,b(x({"data-state":Y(d.checked),"data-disabled":d.disabled?"":void 0},o),{ref:a}))});Q.displayName=K;var Pe=t=>{const n=t,{control:a,checked:s,bubbles:o=!0}=n,d=R(n,["control","checked","bubbles"]),i=l.useRef(null),c=Ce(s),p=oe(a);return l.useEffect(()=>{const u=i.current,g=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(g,"checked").set;if(c!==s&&f){const j=new Event("click",{bubbles:o});f.call(u,s),u.dispatchEvent(j)}},[c,s,o]),e.jsx("input",b(x({type:"checkbox","aria-hidden":!0,defaultChecked:s},d),{tabIndex:-1,ref:i,style:b(x(x({},t.style),p),{position:"absolute",pointerEvents:"none",opacity:0,margin:0})}))};function Y(t){return t?"checked":"unchecked"}var Re=J,Te=Q;const Ee=["1","2","3"],ze=["classic","surface","soft"],Ae=x(x(x({size:{type:"enum",className:"rt-r-size",values:Ee,default:"2",responsive:!0},variant:{type:"enum",className:"rt-variant",values:ze,default:"surface"}},ce),ie),ne),T=l.forwardRef((t,a)=>{const c=le(t,Ae,de),{className:s,color:o,radius:d}=c,i=R(c,["className","color","radius"]);return l.createElement(Re,b(x({"data-accent-color":o,"data-radius":d},i),{asChild:!1,ref:a,className:D("rt-reset","rt-SwitchRoot",s)}),l.createElement(Te,{className:D("rt-SwitchThumb",{"rt-high-contrast":t.highContrast})}))});T.displayName="Switch";const Fe=({message:t,type:a,onClose:s})=>(l.useEffect(()=>{const o=setTimeout(()=>{s()},3e3);return()=>clearTimeout(o)},[s]),e.jsxs("div",{style:{position:"fixed",bottom:"20px",right:"20px",zIndex:1e3,backgroundColor:a==="success"?"var(--green-9)":"var(--red-9)",color:"white",padding:"12px 16px",borderRadius:"4px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.2)",display:"flex",alignItems:"center",gap:"8px"},children:[a==="success"?e.jsx(ve,{size:16}):e.jsx(je,{size:16}),e.jsx(w,{size:"2",children:t})]})),Oe=()=>{const{data:t,isLoading:a,error:s,mutate:o}=pe("Cool Track Settings","Cool Track Settings"),{updateDoc:d,loading:i}=ue(),[c,p]=l.useState({}),[n,u]=l.useState(!1),[g,k]=l.useState(null),[f,j]=l.useState(null),E=(r,h)=>{k({message:r,type:h,show:!0})},y=()=>{k(null)},_=r=>{if(!r)return j("API URL is required"),!1;try{return new URL(r),j(null),!0}catch(h){return j("Please enter a valid URL (e.g., https://example.com/api)"),!1}};if(a)return e.jsx(C,{justify:"center",align:"center",className:"h-[60vh]",children:e.jsx(M,{size:"3"})});if(s||!t)return e.jsx(Se,{size:"4",className:"h-[60vh] flex items-center justify-center",children:e.jsx(W,{children:e.jsxs(C,{direction:"column",gap:"4",align:"center",children:[e.jsx(w,{color:"red",weight:"bold",children:"Error loading settings"}),e.jsx(w,{children:(s==null?void 0:s.message)||"Settings not found"})]})})});const v=(r,h)=>{p(A=>b(x({},A),{[r]:h})),r==="api_url"&&_(h),u(!0)},$=()=>B(void 0,null,function*(){const r=m("api_url");if(_(r))try{yield d("Cool Track Settings","Cool Track Settings",c),o(),u(!1),E("Settings saved successfully!","success")}catch(h){console.error("Error saving settings:",h),E("Failed to save settings. Please try again.","error")}}),z=()=>{p({}),u(!1),j(null)},m=r=>c[r]!==void 0?c[r]:t[r],N=({title:r,icon:h})=>e.jsxs(C,{gap:"3",align:"center",mb:"4",children:[e.jsx(S,{className:"text-gray-500",children:h}),e.jsx(O,{size:"4",weight:"medium",children:r})]}),P=({label:r,description:h,children:A,fullWidth:q=!1})=>e.jsxs(we,{columns:q?"1":"2",gap:"5",mb:"4",children:[e.jsxs(C,{direction:"column",children:[e.jsx(w,{weight:"medium",children:r}),h&&e.jsx(w,{size:"2",color:"gray",mt:"1",children:h})]}),!q&&e.jsx(S,{children:A}),q&&A]});return e.jsxs(S,{className:"px-4 py-3 w-full",children:[(g==null?void 0:g.show)&&e.jsx(Fe,{message:g.message,type:g.type,onClose:y}),n&&e.jsx(S,{className:"bg-white border-b border-gray-200 p-4",style:{position:"sticky",top:50,zIndex:100,backdropFilter:"blur(10px)",backgroundColor:"rgba(255, 255, 255, 0.8)"},children:e.jsx(S,{className:"mx-auto",children:e.jsx(C,{justify:"end",align:"end",children:e.jsxs(C,{gap:"2",children:[e.jsxs(G,{variant:"soft",color:"gray",onClick:z,children:[e.jsx(he,{})," Cancel"]}),e.jsxs(G,{onClick:$,disabled:i||!!f,children:[i?e.jsx(M,{}):e.jsx(me,{})," Save Changes"]})]})})})}),e.jsx(S,{className:"mx-auto py-4",children:e.jsx(W,{className:"shadow-sm w-full",children:e.jsxs(C,{direction:"column",gap:"4",p:"6",children:[e.jsx(O,{size:"6",mb:"4",children:"Settings"}),e.jsx(N,{title:"API Configuration",icon:e.jsx(xe,{})}),e.jsxs(P,{label:"API URL",description:"The endpoint URL for sensor data reception",fullWidth:!0,children:[e.jsx(ke,{value:m("api_url"),onChange:r=>v("api_url",r.target.value),placeholder:"https://example.com/api/method/receive_sensor_data"}),f&&e.jsx(w,{size:"1",color:"red",mt:"1",children:f})]}),e.jsx(V,{size:"4"}),e.jsx(N,{title:"Approval Settings",icon:e.jsx(ge,{})}),e.jsx(P,{label:"Require Gateway Approval",description:"When enabled, all new gateways must be manually approved before they can connect to the server.",children:e.jsx(T,{checked:m("require_gateway_approval"),onCheckedChange:r=>v("require_gateway_approval",r)})}),e.jsx(P,{label:"Require Sensor Approval",description:"When checked, all new sensors must be approved before they can send data to the server.",children:e.jsx(T,{checked:m("require_sensor_approval"),onCheckedChange:r=>v("require_sensor_approval",r)})}),e.jsx(P,{label:"Log Approval Activities",description:"Maintain detailed audit logs of all approval/rejection activities.",children:e.jsx(T,{checked:m("log_approval_activities"),onCheckedChange:r=>v("log_approval_activities",r)})}),e.jsx(V,{size:"4"}),e.jsx(N,{title:"Notification Settings",icon:e.jsx(fe,{})}),e.jsx(P,{label:"Send Approval Notifications",description:"Enable to send email notifications to admins...",children:e.jsx(T,{checked:m("send_approval_notifications"),onCheckedChange:r=>v("send_approval_notifications",r)})})]})})})]})};export{Oe as default};
